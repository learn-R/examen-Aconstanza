frq(datos$P3_1_1) #Cree que será victima de algún delito
find_var(datos, "region")
frq(datos$enc_region)
descr(datos$Fact_Pers)
#4. Selección de variables
datos %>%
filter(enc_region %in% c(3, 6, 8, 9, 13) & Fact_Pers != "NA") %>%
select(identidad_gen = rph_idgen, edad = rph_edad, cvd = P3_1_1, VP_DC, percepcion = P1_2_1, Fact_Pers) %>%
mutate(identidad_gen = as_factor(car::recode(identidad_gen, c("c(88,96,99)=NA"))),
edad = case_when(edad <=3 ~ "Joven",
edad >= 4 & edad <= 6 ~ "Adulto",
edad >= 7 ~ "Adulto mayor",
TRUE ~ NA_character_),
cvd = as_factor(car::recode(cvd, c("c(88,96,99)=NA"))),
percepcion = as_factor(car::recode(percepcion, c("c(88,96,99)=NA")))) %>%
mutate_at(vars(identidad_gen, edad, percepcion, VP_DC), funs(forcats::as_factor(.)))
# 5. Recodificación de variables
datos_proc <- datos %>%
filter(enc_region %in% c(3, 6, 8, 9, 13) & Fact_Pers != "NA") %>%
select(identidad_gen = rph_idgen, edad = rph_edad, cvd = P3_1_1, VP_DC, percepcion = P1_2_1, Fact_Pers) %>%
mutate(identidad_gen = as_factor(car::recode(identidad_gen, c("c(88,96,99)=NA"))),
edad = case_when(edad <=3 ~ "Joven",
edad >= 4 & edad <= 6 ~ "Adulto",
edad >= 7 ~ "Adulto mayor",
TRUE ~ NA_character_),
cvd = as.numeric(car::recode(cvd, c("c(88,96,99)=NA"))),
percepcion = as.numeric(car::recode(percepcion, c("c(88,96,99)=NA"))),
VP_DC = as.numeric(car::recode(VP_DC, c("c(96)=NA")))) %>%
mutate_at(vars(identidad_gen, edad), funs(forcats::as_factor(.)))
summary(datos_proc)
#6. Etiquetado de variables
datos_proc$identidad_gen <- set_label(datos_proc$identidad_gen, 'Identidad de género')
datos_proc$edad <- set_label(datos_proc$edad, 'Edad. 3 categorías')
datos_proc$cvd <- set_label(datos_proc$cvd, 'Cree que será victima de algún delito durante los próximos 12 meses')
datos_proc$VP_DC <- set_label(datos_proc$VP_DC, 'Victimización Personal de Delitos Consumados')
datos_proc$percepcion <- set_label(datos_proc$percepcion, 'percepción de aumento de los delitos en la comuna')
str(datos_proc)
#7. Exportar datos
saveRDS(datos_proc, file= "output/data/datos_proc.rds")
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
magrittr)
datos_proc <- readRDS(file ="output/data/datos_proc.rds")
enusc_design <- as_survey_design(datos_proc, ids = 1, weights = Fact_Pers)
frq(datos_proc$cvd)
datos_proc %>%
select(VP_DC, percepcion) %>%
sjPlot::tab_corr(., corr.method =  "pearson",
title = "Tabla N°1. Matriz de Correlación",
triangle = "lower",
var.labels = c(c("Victimización","Percepción de inseguridad")),
digits = 3,
encoding = "UTF-8")
datos_proc %>%
filter(percepcion <= 1) %>%
plot_frq(identidad_gen,
title = "Percepción de aumento de inseguridad según identidad de género",
type = c("bar"))
modelo1 <- lm(percepcion ~ VP_DC + cvd + edad,
data = datos_proc,
weights = Fact_Pers)
modelo1survey <- svyglm(percepcion ~ VP_DC + cvd + edad,
design = enusc_design,
family = gaussian,
weights = Fact_Pers)
modelo2 <- lm(percepcion ~ VP_DC + cvd + identidad_gen,
data = datos_proc,
weights = Fact_Pers)
modelo2survey <- svyglm(percepcion ~ VP_DC + cvd + identidad_gen,
design = enusc_design,
family = gaussian,
weights = Fact_Pers)
modelo3 <- glm(percepcion ~ VP_DC + cvd + identidad_gen + edad,
data = datos_proc,
family = gaussian)
sjPlot::tab_model(list(modelo1,modelo2),
string.intercept = "(Intercepto)",
string.pred = "Predictores",
string.est = "Estimación",
p.style = "stars",
show.ci = F,
digits = 3,
dv.labels = c("Modelo 1", "Modelo 2"),
show.reflvl = T,
encoding = "UTF-8")
sjPlot::plot_model(modelo1, type = c("est"),
show.intercept = T,
show.values = T,
show.p = T,
show.ci= F,
df.method = 'wald',
digits = 3,
encoding = "UTF-8",
title = "Figura 1. Modelo de regresión lineal para estimar la percepcion de inseguridad según edad")
sjPlot::plot_model(modelo2, type = c("est"),
show.intercept = T,
show.values = T,
show.p = T,
show.ci= F,
df.method = 'wald',
digits = 3,
encoding = "UTF-8",
title = "Figura 1. Modelo de regresión lineal para estimar la percepcion de inseguridad según identidad de género")
modelo3 <- lm(cvd ~ VP_DC + identidad_gen, edad,
data = datos_proc,
weights = Fact_Pers)
modelo4 <- lm(cvd ~ VP_DC + identidad_gen, edad,
data = datos_proc,
weights = Fact_Pers)
#1. Carga de paquetes y datos
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
magrittr)
datos_proc <- readRDS(file ="output/data/datos_proc.rds")
enusc_design <- as_survey_design(datos_proc, ids = 1, weights = Fact_Pers)
frq(datos_proc$cvd)
datos_proc %>%
select(VP_DC, percepcion) %>%
sjPlot::tab_corr(., corr.method =  "pearson",
title = "Tabla N°1. Matriz de Correlación",
triangle = "lower",
var.labels = c(c("Victimización","Percepción de inseguridad")),
digits = 3,
encoding = "UTF-8")
datos_proc %>%
filter(percepcion <= 1) %>%
plot_frq(identidad_gen,
title = "Percepción de aumento de inseguridad según identidad de género",
type = c("bar"))
modelo1 <- lm(percepcion ~ VP_DC + cvd + edad,
data = datos_proc,
weights = Fact_Pers)
modelo1survey <- svyglm(percepcion ~ VP_DC + cvd + edad,
design = enusc_design,
family = gaussian,
weights = Fact_Pers)
modelo2 <- lm(percepcion ~ VP_DC + cvd + identidad_gen,
data = datos_proc,
weights = Fact_Pers)
modelo2survey <- svyglm(percepcion ~ VP_DC + cvd + identidad_gen,
design = enusc_design,
family = gaussian,
weights = Fact_Pers)
modelo3 <- glm(percepcion ~ VP_DC + cvd + identidad_gen + edad,
data = datos_proc,
family = gaussian)
sjPlot::tab_model(list(modelo1,modelo2),
string.intercept = "(Intercepto)",
string.pred = "Predictores",
string.est = "Estimación",
p.style = "stars",
show.ci = F,
digits = 3,
dv.labels = c("Modelo 1", "Modelo 2"),
show.reflvl = T,
encoding = "UTF-8")
sjPlot::plot_model(modelo1, type = c("est"),
show.intercept = T,
show.values = T,
show.p = T,
show.ci= F,
df.method = 'wald',
digits = 3,
encoding = "UTF-8",
title = "Figura 1. Modelo de regresión lineal para estimar la percepcion de inseguridad según edad")
sjPlot::plot_model(modelo2, type = c("est"),
show.intercept = T,
show.values = T,
show.p = T,
show.ci= F,
df.method = 'wald',
digits = 3,
encoding = "UTF-8",
title = "Figura 1. Modelo de regresión lineal para estimar la percepcion de inseguridad según identidad de género")
modelo4 <- lm(cvd ~ VP_DC + identidad_gen, edad,
data = datos_proc,
weights = Fact_Pers)
sjPlot::tab_model(list(modelo2,modelo4),
string.intercept = "(Intercepto)",
string.pred = "Predictores",
string.est = "Estimación",
p.style = "stars",
show.ci = F,
digits = 3,
dv.labels = c("Modelo 1", "Modelo 2"),
show.reflvl = T,
encoding = "UTF-8")
sjPlot::tab_model(list(modelo4),
string.intercept = "(Intercepto)",
string.pred = "Predictores",
string.est = "Estimación",
p.style = "stars",
show.ci = F,
digits = 3,
dv.labels = c("Modelo 1", "Modelo 2"),
show.reflvl = T,
encoding = "UTF-8")
sjPlot::plot_model(modelo2, type = c("est"),
show.intercept = T,
show.values = T,
show.p = T,
show.ci= F,
df.method = 'wald',
digits = 3,
encoding = "UTF-8",
title = "Figura 1. Modelo de regresión lineal para estimar la percepcion de inseguridad según identidad de género")
plot_scatter(
datos_proc,
identidad_gen,
cvd,
VP_DC,
title = "Grafico N°3: temor a ser víctima de algún delito según identidad de género",
jitter = 0.05)
plot_scatter(
datos_proc,
identidad_gen,
VP_DC,
cvd,
title = "Grafico N°3: temor a ser víctima de algún delito según identidad de género",
jitter = 0.05)
sjPlot::tab_model(list(modelo1,modelo2),
string.intercept = "(Intercepto)",
string.pred = "Predictores",
string.est = "Estimación",
p.style = "stars",
show.ci = F,
digits = 3,
dv.labels = c("Modelo 1", "Modelo 2"),
show.reflvl = T,
encoding = "UTF-8")
sjPlot::plot_model(modelo2, type = c("est"),
show.intercept = T,
show.values = T,
show.p = T,
show.ci= F,
df.method = 'wald',
digits = 3,
encoding = "UTF-8",
title = "Gráfico N°2: Modelo de regresión lineal para estimar la percepcion de inseguridad según identidad de género")
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
citr)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
citr)
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
citr)
---
title: "Untitled"
author: "Constanza Acevedo"
date: "22-11-2021"
output:
html_document:
code_folding: hide
theme: lumen
bibliography: input/examen.bib
link-citations: yes
csl: input/apa-single-spaced.csl
---
devtools::install_github("crsh/citr")
install.packages(citr)
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
citr)
knitr::opts_chunk$set(echo = TRUE)
install.packages("citr")
devtools::install_github("crsh/citr")
install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
knitr::opts_chunk$set(echo = TRUE)
devtools::install_github("crsh/citr")
devtools::install_github("crsh/citr")
install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
knitr::opts_chunk$set(echo = TRUE)
devtools::install_github("crsh/citr")
devtools::install_github("crsh/citr")
datos_proc %>%
select(VP_DC, percepcion) %>%
sjPlot::tab_corr(., corr.method =  "pearson",
title = "Tabla N°1. Matriz de Correlación",
triangle = "lower",
var.labels = c(c("Victimización","Percepción de inseguridad")),
digits = 3,
encoding = "UTF-8",
file = "output/figures/matrizcorrelación.doc")
#1. Carga de paquetes y datos
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
magrittr)
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
magrittr)
datos_proc <- readRDS(file ="output/data/datos_proc.rds")
enusc_design <- as_survey_design(datos_proc, ids = 1, weights = Fact_Pers)
frq(datos_proc$cvd)
datos_proc %>%
select(VP_DC, percepcion) %>%
sjPlot::tab_corr(., corr.method =  "pearson",
title = "Tabla N°1. Matriz de Correlación",
triangle = "lower",
var.labels = c(c("Victimización","Percepción de inseguridad")),
digits = 3,
encoding = "UTF-8",
file = "output/figures/matrizcorrelación.doc")
plot_scatter(
datos_proc,
identidad_gen,
VP_DC,
cvd,
title = "Grafico N°1: temor a ser víctima de algún delito según identidad de género",
jitter = 0.05,
file = "output/figures/grafico1_temor.doc")
modelo1 <- lm(percepcion ~ VP_DC + cvd + edad,
data = datos_proc,
weights = Fact_Pers)
modelo1survey <- svyglm(percepcion ~ VP_DC + cvd + edad,
design = enusc_design,
family = gaussian,
weights = Fact_Pers)
modelo2 <- lm(percepcion ~ VP_DC + cvd + identidad_gen,
data = datos_proc,
weights = Fact_Pers)
modelo2survey <- svyglm(percepcion ~ VP_DC + cvd + identidad_gen,
design = enusc_design,
family = gaussian,
weights = Fact_Pers)
modelo3 <- glm(percepcion ~ VP_DC + cvd + identidad_gen + edad,
data = datos_proc,
family = gaussian)
sjPlot::tab_model(list(modelo1,modelo2),
string.intercept = "(Intercepto)",
string.pred = "Predictores",
string.est = "Estimación",
p.style = "stars",
show.ci = F,
digits = 3,
dv.labels = c("Modelo 1", "Modelo 2"),
show.reflvl = T,
encoding = "UTF-8")
datos_proc %>%
filter(percepcion <= 1) %>%
plot_frq(identidad_gen,
title = "Gráfico N°2: Percepción de aumento de inseguridad según identidad de género",
type = c("bar"),
file = "output/figures/grafico2_percepcion.doc")
sjPlot::plot_model(modelo2, type = c("est"),
show.intercept = T,
show.values = T,
show.p = T,
show.ci= F,
df.method = 'wald',
digits = 3,
encoding = "UTF-8",
title = "Gráfico N°3: Modelo de regresión lineal para estimar la percepcion de inseguridad según identidad de género",
file = "output/figures/rl_percepcion.doc")
pacman::p_load(tidyverse,
sjPlot,
sjmisc,
survey,
srvyr,
magrittr)
datos_proc <- readRDS(file ="output/data/datos_proc.rds")
enusc_design <- as_survey_design(datos_proc, ids = 1, weights = Fact_Pers)
frq(datos_proc$cvd)
datos_proc %>%
select(VP_DC, percepcion) %>%
sjPlot::tab_corr(., corr.method =  "pearson",
title = "Tabla N°1. Matriz de Correlación",
triangle = "lower",
var.labels = c(c("Victimización","Percepción de inseguridad")),
digits = 3,
encoding = "UTF-8",
file = "output/figures/matrizcorrelación.doc")
plot_scatter(
datos_proc,
identidad_gen,
VP_DC,
cvd,
title = "Grafico N°1: temor a ser víctima de algún delito según identidad de género",
jitter = 0.05)
modelo1 <- lm(percepcion ~ VP_DC + cvd + edad,
data = datos_proc,
weights = Fact_Pers)
modelo1survey <- svyglm(percepcion ~ VP_DC + cvd + edad,
design = enusc_design,
family = gaussian,
weights = Fact_Pers)
modelo2 <- lm(percepcion ~ VP_DC + cvd + identidad_gen,
data = datos_proc,
weights = Fact_Pers)
modelo2survey <- svyglm(percepcion ~ VP_DC + cvd + identidad_gen,
design = enusc_design,
family = gaussian,
weights = Fact_Pers)
modelo3 <- glm(percepcion ~ VP_DC + cvd + identidad_gen + edad,
data = datos_proc,
family = gaussian)
sjPlot::tab_model(list(modelo1,modelo2),
string.intercept = "(Intercepto)",
string.pred = "Predictores",
string.est = "Estimación",
p.style = "stars",
show.ci = F,
digits = 3,
dv.labels = c("Modelo 1", "Modelo 2"),
show.reflvl = T,
encoding = "UTF-8")
datos_proc %>%
filter(percepcion <= 1) %>%
plot_frq(identidad_gen,
title = "Gráfico N°2: Percepción de aumento de inseguridad según identidad de género",
type = c("bar"))
sjPlot::plot_model(modelo2, type = c("est"),
show.intercept = T,
show.values = T,
show.p = T,
show.ci= F,
df.method = 'wald',
digits = 3,
encoding = "UTF-8",
title = "Gráfico N°3: Modelo de regresión lineal para estimar la percepcion de inseguridad según identidad de género")
pacman::p_load(tidyverse,
sjmisc,
haven,
magrittr,
car,
sjlabelled) #recodificación
#2. Carga de datos
datos <- read_sav("input/data/base-usuario-17-enusc-2020-sav.sav")
#3. Exploración de datos
View(datos)
str(datos)
find_var(datos, "Identidad")
frq(datos$rph_idgen)
find_var(datos, "Edad")
frq(datos$rph_edad)
descr(datos$rph_edad)
find_var(datos, "Victimización")
frq(datos$VP_DC) #Victimización personal delitos consumados
find_var(datos, "comuna")
frq(datos$P1_2_1) #Percepción de aumento de delincuencia en su comuna
find_var(datos, "delito")
frq(datos$P3_1_1) #Cree que será victima de algún delito
find_var(datos, "region")
frq(datos$enc_region)
descr(datos$Fact_Pers)
#4. Selección de variables
datos %>%
filter(enc_region %in% c(3, 6, 8, 9, 13) & Fact_Pers != "NA") %>%
select(identidad_gen = rph_idgen, edad = rph_edad, cvd = P3_1_1, VP_DC, percepcion = P1_2_1, Fact_Pers) %>%
mutate(identidad_gen = as_factor(car::recode(identidad_gen, c("c(88,96,99)=NA"))),
edad = case_when(edad <=3 ~ "Joven",
edad >= 4 & edad <= 6 ~ "Adulto",
edad >= 7 ~ "Adulto mayor",
TRUE ~ NA_character_),
cvd = as_factor(car::recode(cvd, c("c(88,96,99)=NA"))),
percepcion = as_factor(car::recode(percepcion, c("c(88,96,99)=NA")))) %>%
mutate_at(vars(identidad_gen, edad, percepcion, VP_DC), funs(forcats::as_factor(.)))
# 5. Recodificación de variables
datos_proc <- datos %>%
filter(enc_region %in% c(3, 6, 8, 9, 13) & Fact_Pers != "NA") %>%
select(identidad_gen = rph_idgen, edad = rph_edad, cvd = P3_1_1, VP_DC, percepcion = P1_2_1, Fact_Pers) %>%
mutate(identidad_gen = as_factor(car::recode(identidad_gen, c("c(88,96,99)=NA"))),
edad = case_when(edad <=3 ~ "Joven",
edad >= 4 & edad <= 6 ~ "Adulto",
edad >= 7 ~ "Adulto mayor",
TRUE ~ NA_character_),
cvd = as.numeric(car::recode(cvd, c("c(88,96,99)=NA"))),
percepcion = as.numeric(car::recode(percepcion, c("c(88,96,99)=NA"))),
VP_DC = as.numeric(car::recode(VP_DC, c("c(96)=NA")))) %>%
mutate_at(vars(identidad_gen, edad), funs(forcats::as_factor(.)))
summary(datos_proc)
#6. Etiquetado de variables
datos_proc$identidad_gen <- set_label(datos_proc$identidad_gen, 'Identidad de género')
datos_proc$edad <- set_label(datos_proc$edad, 'Edad. 3 categorías')
datos_proc$cvd <- set_label(datos_proc$cvd, 'Cree que será victima de algún delito durante los próximos 12 meses')
datos_proc$VP_DC <- set_label(datos_proc$VP_DC, 'Victimización Personal de Delitos Consumados')
datos_proc$percepcion <- set_label(datos_proc$percepcion, 'percepción de aumento de los delitos en la comuna')
str(datos_proc)
#7. Exportar datos
saveRDS(datos_proc, file= "output/data/datos_proc.rds")
